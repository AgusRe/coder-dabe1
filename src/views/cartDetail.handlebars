<h1>Carrito {{cart._id}}</h1>

{{#if cart.products.length}}
  <ul>
    {{#each cart.products}}
      <li>
        <strong>{{this.product.title}}</strong> - ${{this.product.price}} (Cantidad: {{this.quantity}})
      </li>
    {{/each}}
  </ul>
  <form action="/api/carts/{{cart._id}}" method="post" onsubmit="event.preventDefault(); emptyCart('{{cart._id}}')">
    <button type="submit">Vaciar carrito</button>
  </form>
{{else}}
  <p>El carrito está vacío</p>
{{/if}}

<p><a href="/products">Seguir comprando</a></p>

<script>
async function emptyCart(cid) {
  const resp = await fetch('/api/carts/' + cid, { method: 'DELETE' });
  if (resp.ok) location.reload();
  else alert('Error al vaciar carrito');
}
</script>
