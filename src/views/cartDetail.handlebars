<h1>Carrito {{cart._id}}</h1>

{{#if cart.products.length}}
  <ul class="list-group mb-3">
    {{#each cart.products}}
      <li class="list-group-item d-flex justify-content-between align-items-center">
        <span><strong>{{this.product.title}}</strong> - ${{this.product.price}}</span>
        <span class="badge bg-primary rounded-pill">x{{this.quantity}}</span>
      </li>
    {{/each}}
  </ul>
  <button class="btn btn-danger" onclick="emptyCart('{{cart._id}}')">Vaciar carrito</button>
{{else}}
  <p class="alert alert-info">El carrito está vacío</p>
{{/if}}

<a href="/products" class="btn btn-link mt-3">Seguir comprando</a>

<script>
async function emptyCart(cid) {
  const resp = await fetch('/api/carts/' + cid, { method: 'DELETE' });
  if (resp.ok) location.reload();
  else alert('Error al vaciar carrito');
}
</script>
